# MNIST Классификатор

Проект для классификации рукописных цифр MNIST с использованием нейронной сети на TensorFlow/Keras.

## Описание проекта

Этот проект реализует классификатор рукописных цифр (0-9) на основе набора данных MNIST. Модель представляет собой полносвязную нейронную сеть, которая обучается распознавать цифры с высокой точностью.

### Возможности:
- Загрузка и предобработка данных MNIST
- Обучение нейронной сети с архитектурой Dense слоев
- Оценка качества модели на тестовых данных
- Визуализация процесса обучения и результатов
- Детальный анализ ошибок классификации
- Логирование всех этапов работы
- Полное подавление предупреждений TensorFlow

## Структура проекта

```
mnist-classifier/
├── src/
│   ├── main.py                    # Основной файл запуска
│   ├── models/                    # Пакет с моделями и обработкой данных
│   │   ├── __init__.py           # Инициализация пакета models
│   │   ├── config.py             # Настройка окружения и подавление предупреждений
│   │   ├── data_processor.py     # Загрузка и предобработка данных MNIST
│   │   └── neural_network.py     # Архитектура, обучение и оценка модели
│   └── utils/                     # Пакет с утилитами
│       ├── __init__.py           # Инициализация пакета utils
│       ├── logger_config.py      # Настройка системы логирования
│       └── visualizer.py         # Создание графиков и визуализаций
├── logs/                          # Файлы логов (создается автоматически)
├── results/                       # Сохраненные графики результатов (создается автоматически)
├── requirements.txt               # Зависимости проекта
└── README.md                     # Данный файл
```

## Установка и запуск

### 1. Клонирование репозитория
```bash
git clone <url-репозитория>
cd mnist-classifier
```

### 2. Создание виртуального окружения
```bash
# Создание виртуального окружения
python -m venv venv

# Активация виртуального окружения
# На Linux/macOS:
source venv/bin/activate
# На Windows:
venv\Scripts\activate
```

### 3. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 4. Запуск программы
```bash
cd src
python main.py
```

## Результаты работы

После запуска программы создаются следующие файлы:

### Логи
- Файлы в папке `logs/` с именами `training_log_YYYYMMDD_HHMMSS.log`
- Содержат подробную информацию о процессе обучения
- Включают метрики качества модели и временные отметки

### Графики
- Файлы в папке `results/` с именами `training_results_YYYYMMDD_HHMMSS.png`
- Содержат 4 графика:
  1. **Функция потерь** - изменение ошибки во время обучения
  2. **Точность** - изменение точности на обучающей и валидационной выборках
  3. **Матрица ошибок** - анализ качества классификации по классам
  4. **Примеры ошибок** - визуализация неправильно классифицированных изображений

## Архитектура кода

### Модули проекта

#### `models/` - Основная логика модели
- **`config.py`** - Автоматическая настройка окружения для подавления предупреждений TensorFlow
- **`data_processor.py`** - Загрузка MNIST, нормализация и one-hot encoding
- **`neural_network.py`** - Создание, компиляция, обучение и оценка нейронной сети

#### `utils/` - Вспомогательные утилиты
- **`logger_config.py`** - Настройка логирования в файл и консоль
- **`visualizer.py`** - Создание и сохранение графиков результатов

#### `main.py` - Точка входа
- Координирует работу всех модулей
- Обеспечивает правильный порядок импортов для подавления предупреждений

## Архитектура модели

Модель представляет собой полносвязную нейронную сеть:
- **Входной слой**: 784 нейрона (28x28 пикселей)
- **Скрытый слой 1**: 128 нейронов + ReLU + Dropout(0.2)
- **Скрытый слой 2**: 64 нейрона + ReLU + Dropout(0.1)
- **Выходной слой**: 10 нейронов (10 классов) + Softmax

### Параметры обучения:
- **Оптимизатор**: Adam
- **Функция потерь**: Categorical Crossentropy
- **Метрика**: Accuracy
- **Количество эпох**: 15
- **Размер батча**: 128
- **Валидационная выборка**: 10% от обучающих данных

## Особенности реализации

### Подавление предупреждений TensorFlow
Проект автоматически подавляет все предупреждения TensorFlow:
- Настройки окружения применяются при импорте `models.config`
- Принудительное использование CPU (отключение GPU)
- Отключение oneDNN оптимизаций
- Подавление логов CUDA и XLA

### Модульная архитектура
- Разделение ответственности между модулями
- Легкость тестирования и расширения
- Чистый код с документацией

## Ожидаемые результаты

- **Точность на тестовых данных**: ~97-98%
- **Время обучения**: ~2-5 минут (зависит от системы)
- **Размер модели**: Небольшой, подходит для быстрого обучения
- **Работа без предупреждений**: Чистый вывод только с полезной информацией

## Требования к системе

- Python 3.8+
- Оперативная память: минимум 4GB
- Место на диске: ~500MB для данных и результатов
- Процессор: любой (используется CPU, GPU не требуется)

## Устранение неполадок

### Проблемы с установкой TensorFlow
```bash
# Если возникают проблемы с TensorFlow, попробуйте:
pip install --upgrade pip
pip install tensorflow==2.15.0 --no-cache-dir
```

### Проблемы с правами доступа
```bash
# Убедитесь, что у вас есть права на создание папок logs/ и results/
mkdir -p logs results
chmod 755 logs results
```

### Проблемы с импортами модулей
```bash
# Убедитесь, что запускаете из папки src/
cd src
python main.py

# Проверьте наличие файлов __init__.py в папках models/ и utils/
```

## Автор

Проект создан для демонстрации классификации изображений с помощью нейронных сетей.
